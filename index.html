<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Oyunu - Çevrimiçi ve Çevrimdışı Mod</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #fff;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(15, 30, 45, 0.9);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .auth-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .auth-box {
            background: rgba(15, 30, 45, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        
        .auth-box h2 {
            margin-bottom: 20px;
            color: #ffd43b;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
        }
        
        .auth-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .auth-tab.active {
            border-bottom: 2px solid #ffd43b;
            color: #ffd43b;
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        .auth-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        
        .auth-btn {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: none;
            border-radius: 8px;
            background: linear-gradient(90deg, #339af0, #22b8cf);
            color: white;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .auth-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .auth-switch {
            margin-top: 15px;
            font-size: 0.9rem;
        }
        
        .auth-switch a {
            color: #ffd43b;
            text-decoration: none;
            cursor: pointer;
        }
        
        .user-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(100, 180, 255, 0.2);
            border-radius: 10px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(90deg, #339af0, #22b8cf);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .logout-btn {
            padding: 8px 15px;
            background: linear-gradient(90deg, #ff6b6b, #ff8787);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .game-mode {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .mode-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            background: rgba(100, 180, 255, 0.2);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-btn.active {
            background: linear-gradient(90deg, #339af0, #22b8cf);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .online-panel {
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(100, 180, 255, 0.2);
            border-radius: 12px;
            display: none;
        }
        
        .online-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .player-id {
            font-weight: bold;
            color: #ffd43b;
        }
        
        .connection-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .connected {
            background: linear-gradient(90deg, #12b886, #40c057);
        }
        
        .disconnected {
            background: linear-gradient(90deg, #ff6b6b, #ff8787);
        }
        
        .online-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .game-info {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            background: rgba(100, 180, 255, 0.2);
            padding: 15px;
            border-radius: 12px;
            gap: 15px;
        }
        
        .score-board {
            display: flex;
            gap: 20px;
        }
        
        .player-score {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .score {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .current-player {
            font-size: 1.2rem;
            margin-top: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            background: linear-gradient(90deg, #00b09b, #96c93d);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .player1 { color: #63e6be; }
        .player2 { color: #ff8787; }
        
        .time-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin: 10px 0 20px;
            overflow: hidden;
        }
        
        .time-left {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s linear;
        }
        
        .player1-time { background: linear-gradient(90deg, #339af0, #22b8cf); }
        .player2-time { background: linear-gradient(90deg, #ff6b6b, #ff8787); }
        
        .time-warning {
            text-align: center;
            font-size: 1rem;
            margin-bottom: 5px;
            height: 20px;
            color: #ffd43b;
        }
        
        .letter-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .letter-btn {
            padding: 15px 30px;
            font-size: 1.5rem;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .letter-btn.s {
            background: linear-gradient(90deg, #339af0, #22b8cf);
            color: white;
        }
        
        .letter-btn.o {
            background: linear-gradient(90deg, #ff6b6b, #ff8787);
            color: white;
        }
        
        .letter-btn.selected {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 6px;
            margin: 15px 0;
            background: rgba(100, 180, 255, 0.15);
            padding: 15px;
            border-radius: 12px;
            position: relative;
        }

        .cell {
            width: 100%;
            aspect-ratio: 1;
            background: rgba(245, 245, 255, 0.9);
            border: 2px solid rgba(200, 200, 210, 0.7);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 2;
        }
        
        .cell:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 1);
        }
        
        .cell.s { color: #339af0; }
        .cell.o { color: #ff6b6b; }
        
        .cell.sos-cell {
            background: rgba(255, 215, 0, 0.2);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .ctrl-btn {
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .undo-btn {
            background: linear-gradient(90deg, #4c6ef5, #228be6);
            color: white;
        }
    
        .reset-btn {
            background: linear-gradient(90deg, #f76707, #fd7e14);
            color: white;
        }
        
        .new-game-btn {
            background: linear-gradient(90deg, #12b886, #40c057);
            color: white;
        }
        
        .help-btn {
            background: linear-gradient(90deg, #ae3ec9, #cc5de8);
            color: white;
        }
        
        .online-btn {
            background: linear-gradient(90deg, #fd7e14, #fcc419);
            color: white;
        }
        
        .ctrl-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .game-over {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            display: none;
        }
        
        .winner-text {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffd43b;
        }
        
        .instructions {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }
        
        .instructions h2 {
            margin-bottom: 15px;
            color: #ffd43b;
        }
        
        .instructions p {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .sos-line {
            position: absolute;
            background: rgba(255, 215, 0, 0.7);
            z-index: 1;
            transform-origin: 0 0;
            pointer-events: none;
        }
        
        .cell-container {
            position: relative;
        }

        /* Tablet boyutları için */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
                margin: 10px;
            }
            
            h1 {
                font-size: 2rem !important;
            }
            
            .game-info {
                flex-direction: column;
                gap: 15px;
                padding: 12px;
            }
            
            .score-board {
                width: 100%;
                justify-content: space-around;
            }
            
            .current-player {
                width: 100%;
                text-align: center;
                font-size: 1.1rem;
            }
            
            .letter-selector {
                gap: 15px;
                margin: 15px 0;
            }
            
            .letter-btn {
                padding: 12px 20px;
                font-size: 1.3rem;
                flex: 1;
                max-width: 80px;
            }
            
            .game-board {
                gap: 4px;
                padding: 12px;
            }
            
            .cell {
                font-size: 1.3rem;
                border-radius: 6px;
            }
            
            .controls {
                flex-wrap: wrap;
            }
            
            .ctrl-btn {
                flex: 1;
                min-width: 120px;
                margin: 5px;
            }
            
            .auth-box {
                padding: 20px;
            }
            
            .game-mode {
                flex-direction: column;
            }
        }

        /* Mobil boyutları için */
        @media (max-width: 480px) {
            h1 {
                font-size: 1.7rem !important;
            }
            
            .score {
                font-size: 1.7rem !important;
            }
            
            .letter-btn {
                padding: 10px 15px;
                font-size: 1.2rem;
                max-width: 70px;
            }
            
            .game-board {
                gap: 3px;
                padding: 10px;
            }
            
            .cell {
                font-size: 1.1rem;
                border-width: 1px;
            }
            
            .ctrl-btn {
                padding: 10px 15px;
                font-size: 0.9rem;
                min-width: 100px;
            }
            
            .instructions {
                padding: 15px;
            }
            
            .instructions h2 {
                font-size: 1.3rem;
            }
            
            .instructions p {
                font-size: 0.9rem;
            }
            
            .auth-box {
                width: 95%;
                padding: 15px;
            }
            
            .auth-input, .auth-btn {
                padding: 10px;
            }
            
            .online-controls {
                flex-direction: column;
            }
        }

        /* Çok küçük ekranlar için */
        @media (max-width: 360px) {
            .game-board {
                grid-template-columns: repeat(8, 1fr);
                gap: 2px;
                padding: 8px;
            }
            
            .cell {
                font-size: 0.9rem;
            }
            
            .letter-btn {
                padding: 8px 12px;
                font-size: 1.1rem;
            }
            
            .ctrl-btn {
                padding: 8px 12px;
                min-width: 90px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Kimlik Doğrulama Ekranı -->
    <div id="auth-container" class="auth-container">
        <div class="auth-box">
            <h2>SOS Oyunu</h2>
            <div class="auth-tabs">
                <div class="auth-tab active" id="login-tab">Giriş Yap</div>
                <div class="auth-tab" id="register-tab">Kayıt Ol</div>
            </div>
            
            <div id="login-form" class="auth-form active">
                <input type="email" id="login-email" class="auth-input" placeholder="E-posta" required>
                <input type="password" id="login-password" class="auth-input" placeholder="Şifre" required>
                <button id="login-btn" class="auth-btn">Giriş Yap</button>
                <div class="auth-switch">Hesabınız yok mu? <a id="switch-to-register">Kayıt Olun</a></div>
            </div>
            
            <div id="register-form" class="auth-form">
                <input type="text" id="register-name" class="auth-input" placeholder="Ad" required>
                <input type="text" id="register-surname" class="auth-input" placeholder="Soyad" required>
                <input type="email" id="register-email" class="auth-input" placeholder="E-posta" required>
                <input type="password" id="register-password" class="auth-input" placeholder="Şifre" required>
                <input type="password" id="register-confirm" class="auth-input" placeholder="Şifre Tekrar" required>
                <button id="register-btn" class="auth-btn">Kayıt Ol</button>
                <div class="auth-switch">Zaten hesabınız var mı? <a id="switch-to-login">Giriş Yapın</a></div>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>SOS OYUNU</h1>
            <p>Stratejini kullan, SOS yap, puanları topla!</p>
        </header>
        
        <!-- Kullanıcı Paneli -->
        <div id="user-panel" class="user-panel" style="display: none;">
            <div class="user-info">
                <div class="user-avatar" id="user-avatar">U</div>
                <div id="user-name">Kullanıcı</div>
            </div>
            <button id="logout-btn" class="logout-btn">Çıkış Yap</button>
        </div>
        
        <!-- Oyun Modu Seçimi -->
        <div class="game-mode">
            <button id="offline-mode" class="mode-btn active">Çevrimdışı Oyna</button>
            <button id="online-mode" class="mode-btn">Çevrimiçi Oyna</button>
        </div>
        
        <!-- Çevrimiçi Oyun Paneli -->
        <div id="online-panel" class="online-panel">
            <div class="online-status">
                <div>Oda ID: <span id="player-id" class="player-id">---</span></div>
                <div id="connection-status" class="connection-status disconnected">Bağlı Değil</div>
            </div>
            <div class="online-controls">
                <input type="text" id="room-id" class="auth-input" placeholder="Oda ID'si" style="margin: 0;">
                <button id="create-room" class="ctrl-btn online-btn">Oda Oluştur</button>
                <button id="join-room" class="ctrl-btn online-btn">Odaya Katıl</button>
            </div>
            <div id="online-info" style="margin-top: 10px; font-size: 0.9rem;"></div>
        </div>
        
        <div class="game-info">
            <div class="score-board">
                <div class="player-score">
                    <div class="player1" id="player1-name">OYUNCU 1</div>
                    <div id="score1" class="score">0</div>
                </div>
                <div class="player-score">
                    <div class="player2" id="player2-name">OYUNCU 2</div>
                    <div id="score2" class="score">0</div>
                </div>
            </div>
            <div id="current-player" class="current-player">Sıra: Oyuncu 1</div>
        </div>
        
        <div class="time-warning" id="time-warning"></div>
        <div class="time-bar">
            <div id="time-left" class="time-left player1-time" style="width: 100%"></div>
        </div>
        
        <div class="letter-selector">
            <button id="letter-s" class="letter-btn s selected">S</button>
            <button id="letter-o" class="letter-btn o">O</button>
        </div>
        
        <div class="game-board" id="game-board">
            <!-- JavaScript ile hücreler buraya eklenecek -->
        </div>
        
        <div class="controls">
            <button class="ctrl-btn undo-btn" onclick="undoMove()">Geri Al</button>
            <button class="ctrl-btn reset-btn" onclick="resetGame()">Sıfırla</button>
            <button class="ctrl-btn new-game-btn" onclick="newGame()">Yeni Oyun</button>
            <button class="ctrl-btn online-btn" onclick="toggleOnlineMode()">Çevrimiçi</button>
            <button class="ctrl-btn help-btn" onclick="toggleInstructions()">Yardım</button>
        </div>
        
        <div id="game-over" class="game-over">
            <div id="winner-text" class="winner-text">OYUNCU 1 KAZANDI!</div>
            <button class="ctrl-btn new-game-btn" onclick="newGame()">YENİDEN BAŞLA</button>
        </div>
        
        <div id="instructions" class="instructions" style="display: none;">
            <h2>Nasıl Oynanır?</h2>
            <p>1. Sıradaki oyuncu S veya O harflerinden birini seçer.</p>
            <p>2. Seçilen harf oyun tahtasındaki bir kareye yerleştirilir.</p>
            <p>3. Eğer bir SOS oluşturulursa (dikey, yatay veya çapraz), oyuncu bir puan kazanır ve tekrar oynar.</p>
            <p>4. SOS oluşturamayan oyuncu, sırayı rakibine devreder.</p>
            <p>5. Tüm kareler dolduğunda en çok puanı alan oyuncu kazanır.</p>
            <p>6. Her oyuncunun 15 saniyelik süresi vardır. Süre dolduğunda sıra diğer oyuncuya geçer.</p>
            <p>7. Çevrimiçi modda başka oyuncularla oynayabilirsiniz.</p>
        </div>
    </div>

    <script>
            // Socket.io bağlantısı - Sunucu URL'sini otomatik algıla
    const serverUrl = window.location.origin;
    const socket = io(serverUrl, {
        transports: ['websocket', 'polling']
    });

    // Socket olaylarını dinle
    socket.on('connect', () => {
        console.log('Sunucuya bağlandı');
        if (document.getElementById('connection-status')) {
            document.getElementById('connection-status').textContent = 'Bağlandı';
            document.getElementById('connection-status').className = 'connection-status connected';
        }
    });

    socket.on('disconnect', () => {
        console.log('Sunucu bağlantısı kesildi');
        if (document.getElementById('connection-status')) {
            document.getElementById('connection-status').textContent = 'Bağlantı Kesildi';
            document.getElementById('connection-status').className = 'connection-status disconnected';
        }
    });

    socket.on('error', (data) => {
        alert(data.message);
    });

    socket.on('room-created', (data) => {
        if (document.getElementById('online-info')) {
            document.getElementById('online-info').textContent = data.message;
            document.getElementById('room-id').value = data.roomId;
        }
    });

    socket.on('player-joined', (data) => {
        if (document.getElementById('online-info')) {
            document.getElementById('online-info').textContent = data.message;
        }
    });

    socket.on('game-started', (data) => {
        // Oyunu başlat
        board = data.board;
        currentPlayer = data.currentPlayer;
        scores = data.scores;
        
        updateScores();
        updateCurrentPlayerDisplay();
        renderBoard();
        
        if (document.getElementById('online-info')) {
            document.getElementById('online-info').textContent = 'Oyun başladı!';
        }
    });

    socket.on('move-made', (data) => {
        // Rakibin hamlesini işle
        board[data.row][data.col] = data.letter;
        scores = data.scores;
        currentPlayer = data.currentPlayer;
        
        updateCell(data.row, data.col, data.letter);
        updateScores();
        updateCurrentPlayerDisplay();
        
        // SOS yapıldıysa çiz
        if (data.sosCount > 0) {
            // Burada SOS çizme fonksiyonunu çağırabilirsiniz
            checkForSOS(data.row, data.col);
        }
    });

    socket.on('player-left', (data) => {
        alert(`${data.playerName} oyundan ayrıldı. Oyun sonlandırılıyor.`);
        resetGame();
    });

    socket.on('game-over', (data) => {
        gameOver = true;
        const gameOverEl = document.getElementById('game-over');
        const winnerText = document.getElementById('winner-text');
        
        if (data.winner === -1) {
            winnerText.textContent = 'BERABERE!';
            winnerText.style.color = '#ffd43b';
        } else {
            const winnerName = data.winner === 0 ? 'OYUNCU 1' : 'OYUNCU 2';
            winnerText.textContent = `${winnerName} KAZANDI!`;
            winnerText.style.color = data.winner === 0 ? '#63e6be' : '#ff8787';
        }
        
        gameOverEl.style.display = 'block';
    });

    // Oda linklerini paylaşılabilir yap
    function copyRoomLink() {
        const roomId = document.getElementById('room-id').value;
        const roomLink = `${window.location.origin}?room=${roomId}`;
        navigator.clipboard.writeText(roomLink);
        alert('Oda linki kopyalandı: ' + roomLink);
    }
    
    // URL'den oda ID'sini oku
    function getRoomIdFromUrl() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('room');
    }
    
    // Sayfa yüklendiğinde oda ID'sini kontrol et
    window.addEventListener('load', () => {
        const roomId = getRoomIdFromUrl();
        if (roomId) {
            document.getElementById('room-id').value = roomId;
            document.getElementById('online-info').textContent = 'URL\'den oda ID\'si algılandı. "Odaya Katıl" butonuna tıklayın.';
        }
    });

        // Oyun değişkenleri
        let board = [];
        const boardSize = 8;
        let currentPlayer = 1;
        let scores = [0, 0];
        let selectedLetter = 'S';
        let gameOver = false;
        let sosLines = [];
        
        // Zamanlama değişkenleri
        let timeLeft = 15;
        let timerInterval = null;
        
        // Hamle geçmişi için değişken
        let moveHistory = [];
        
        // Kullanıcı ve oyun modu değişkenleri
        let playerName = "";
        let playerEmail = "";
        let playerId = generateId();
        let isOnlineMode = false;
        let isLoggedIn = false;
        let gameMode = "offline"; // "offline" veya "online"
        let userData = null;
        let currentRoomId = "";
        
        // Rastgele ID oluşturma
        function generateId() {
            return Math.random().toString(36).substring(2, 10).toUpperCase();
        }
        
        // Oyun tahtasını oluştur
        function initializeBoard() {
            const gameBoard = document.getElementById('game-board');
            gameBoard.innerHTML = '';
            board = [];
            
            // SOS çizgilerini temizle
            document.querySelectorAll('.sos-line').forEach(line => line.remove());
            
            for (let i = 0; i < boardSize; i++) {
                board[i] = [];
                for (let j = 0; j < boardSize; j++) {
                    board[i][j] = '';
                    
                    const cellContainer = document.createElement('div');
                    cellContainer.className = 'cell-container';
                    
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    cell.addEventListener('click', () => makeMove(i, j));
                    
                    cellContainer.appendChild(cell);
                    gameBoard.appendChild(cellContainer);
                }
            }
        }
        
        // Zamanlayıcıyı başlat
        function startTimer() {
            // Önceki zamanlayıcıyı temizle
            clearInterval(timerInterval);
            
            timeLeft = 15;
            updateTimerDisplay();
            
            // Zamanlayıcıyı başlat
            timerInterval = setInterval(() => {
                timeLeft -= 0.1;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    // Süre doldu, sıra diğer oyuncuya geçer
                    if (gameMode === "offline") {
                        makeRandomMove();
                    } else {
                        switchPlayer();
                    }
                }
            }, 100);
        }
        
        // Zamanlayıcı görüntüsünü güncelle
        function updateTimerDisplay() {
            const timeLeftBar = document.getElementById('time-left');
            const timeWarning = document.getElementById('time-warning');
            
            // Zaman çubuğunu güncelle
            const percentage = (timeLeft / 15) * 100;
            timeLeftBar.style.width = `${percentage}%`;
            
            // Zaman uyarısını güncelle
            if (timeLeft < 3) {
                timeWarning.textContent = `Dikkat! ${timeLeft.toFixed(1)} saniye kaldı!`;
            } else {
                timeWarning.textContent = '';
            }
            
            // Zaman çubuğu rengini oyuncuaya göre ayarla
            if (currentPlayer === 1) {
                timeLeftBar.className = 'time-left player1-time';
            } else {
                timeLeftBar.className = 'time-left player2-time';
            }
        }
        
        // Oyuncu değiştirme
        function switchPlayer() {
            currentPlayer = currentPlayer === 1 ? 2 : 1;
            updateCurrentPlayerDisplay();
            
            // Rastgele S veya O seç (%70 S, %30 O)
            selectedLetter = Math.random() < 0.7 ? 'S' : 'O';
            
            // Seçili harfi güncelle
            document.getElementById('letter-s').classList.toggle('selected', selectedLetter === 'S');
            document.getElementById('letter-o').classList.toggle('selected', selectedLetter === 'O');
            
            startTimer(); // Yeni oyuncu için zamanlayıcıyı başlat
            
            // Çevrimiçi moddaysa sıra değişikliğini rakip oyuncuya ilet
            if (gameMode === "online" && socket.connected) {
                socket.emit('switch-turn', { 
                    roomId: currentRoomId, 
                    player: currentPlayer, 
                    letter: selectedLetter 
                });
            }
        }
        
        // Rastgele hamle yap (robot için)
        function makeRandomMove() {
            if (gameOver) return;
            
            // Boş hücreleri bul
            const emptyCells = [];
            for (let i = 0; i < boardSize; i++) {
                for (let j = 0; j < boardSize; j++) {
                    if (board[i][j] === '') {
                        emptyCells.push({row: i, col: j});
                    }
                }
            }
            
            // Eğer boş hücre kalmadıysa oyunu bitir
            if (emptyCells.length === 0) {
                endGame();
                return;
            }
            
            // Rastgele bir hücre seç
            const randomIndex = Math.floor(Math.random() * emptyCells.length);
            const randomCell = emptyCells[randomIndex];
            
            // Rastgele S veya O seç (%70 S, %30 O)
            const randomLetter = Math.random() < 0.7 ? 'S' : 'O';
            selectedLetter = randomLetter;
            
            // Seçili harfi güncelle
            document.getElementById('letter-s').classList.toggle('selected', randomLetter === 'S');
            document.getElementById('letter-o').classList.toggle('selected', randomLetter === 'O');
            
            // Hamleyi yap
            // Hamleyi history'e kaydet
            moveHistory.push({
                row: randomCell.row,
                col: randomCell.col,
                letter: randomLetter,
                player: currentPlayer,
                scores: [...scores] // scores array'inin kopyası
            });
            
            board[randomCell.row][randomCell.col] = randomLetter;
            updateCell(randomCell.row, randomCell.col, randomLetter);
            
            // SOS kontrolü
            const sosCount = checkForSOS(randomCell.row, randomCell.col);
            
            if (sosCount > 0) {
                scores[currentPlayer - 1] += sosCount;
                updateScores();
                
                // SOS yapıldığı için aynı oyuncu tekrar oynar
                if (isBoardFull()) {
                    clearInterval(timerInterval);
                    endGame();
                } else {
                    // Zamanlayıcıyı yeniden başlat
                    startTimer();
                }
            } else {
                // SOS yapılamadı, sıra diğer oyuncuya geçer
                switchPlayer();
                
                if (isBoardFull()) {
                    clearInterval(timerInterval);
                    endGame();
                }
            }
        }
        
        // Hamle geri alma fonksiyonu
        function undoMove() {
            if (gameOver || moveHistory.length === 0) return;
            
            // Son hamleyi history'den al
            const lastMove = moveHistory.pop();
            
            // Hamleyi geri al
            board[lastMove.row][lastMove.col] = '';
            const cell = document.querySelector(`.cell[data-row="${lastMove.row}"][data-col="${lastMove.col}"]`);
            cell.textContent = '';
            cell.classList.remove('s', 'o', 'sos-cell');
            
            // SOS çizgilerini temizle
            document.querySelectorAll('.sos-line').forEach(line => line.remove());
            
            // Skorları eski haline getir
            scores = [...lastMove.scores];
            updateScores();
            
            // Oyuncu sırasını eski haline getir
            currentPlayer = lastMove.player;
            updateCurrentPlayerDisplay();
            
            // Seçili harfi eski haline getir
            selectedLetter = lastMove.letter;
            document.getElementById('letter-s').classList.toggle('selected', selectedLetter === 'S');
            document.getElementById('letter-o').classList.toggle('selected', selectedLetter === 'O');
            
            // Zamanlayıcıyı yeniden başlat
            startTimer();
            
            // Oyun bittiyse geri alındığı için oyunu yeniden başlat
            if (gameOver) {
                gameOver = false;
                document.getElementById('game-over').style.display = 'none';
            }
            
            // Çevrimiçi moddaysa hamle geri almayı rakip oyuncuya ilet
            if (gameMode === "online" && socket.connected) {
                socket.emit('undo-move', { roomId: currentRoomId });
            }
        }
        
        // Hamle yap
        function makeMove(row, col) {
            if (gameOver || board[row][col] !== '') return;
            
            // Çevrimiçi moddaysa ve sıra sizde değilse hamle yapamazsınız
            if (gameMode === "online") {
                const isMyTurn = (currentPlayer === 1);
                if (!isMyTurn) {
                    alert("Sıra rakibinizde!");
                    return;
                }
            }
            
            // Mevcut hamleyi history'e kaydet
            moveHistory.push({
                row: row,
                col: col,
                letter: selectedLetter,
                player: currentPlayer,
                scores: [...scores] // scores array'inin kopyası
            });
            
            // Zamanlayıcıyı sıfırla
            startTimer();
            
            board[row][col] = selectedLetter;
            updateCell(row, col, selectedLetter);
            
            // Çevrimiçi moddaysa hamleyi rakip oyuncuya ilet
            if (gameMode === "online" && socket.connected) {
                socket.emit('make-move', { 
                    roomId: currentRoomId, 
                    row, 
                    col, 
                    letter: selectedLetter,
                    player: currentPlayer
                });
            }
            
            // SOS kontrolü
            const sosCount = checkForSOS(row, col);
            
            if (sosCount > 0) {
                scores[currentPlayer - 1] += sosCount;
                updateScores();
                
                // SOS yapıldığı için aynı oyuncu tekrar oynar
                if (isBoardFull()) {
                    clearInterval(timerInterval);
                    endGame();
                }
            } else {
                // SOS yapılamadı, sıra diğer oyuncuya geçer
                if (gameMode === "offline") {
                    // Çevrimdışı modda robot hamle yapar
                    setTimeout(() => {
                        makeRandomMove();
                    }, 1000);
                } else {
                    switchPlayer();
                }
                
                if (isBoardFull()) {
                    clearInterval(timerInterval);
                    endGame();
                }
            }
        }
        
        // Hücreyi güncelle
        function updateCell(row, col, letter) {
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            cell.textContent = letter;
            cell.classList.add(letter.toLowerCase());
        }
        
        // Tahtayı render et
        function renderBoard() {
            const gameBoard = document.getElementById('game-board');
            gameBoard.innerHTML = '';
            
            for (let i = 0; i < boardSize; i++) {
                for (let j = 0; j < boardSize; j++) {
                    const cellContainer = document.createElement('div');
                    cellContainer.className = 'cell-container';
                    
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    cell.addEventListener('click', () => makeMove(i, j));
                    
                    if (board[i][j] !== '') {
                        cell.textContent = board[i][j];
                        cell.classList.add(board[i][j].toLowerCase());
                    }
                    
                    cellContainer.appendChild(cell);
                    gameBoard.appendChild(cellContainer);
                }
            }
        }
        
        // SOS kontrolü
        function checkForSOS(row, col) {
            let count = 0;
            const letter = board[row][col];
            
            // Sadece 'O' harfi için SOS kontrol et (çünkü S harfi merkezde olmaz)
            if (letter === 'O') {
                // Yatay kontrol (S-O-S)
                if (col > 0 && col < boardSize - 1) {
                    if (board[row][col-1] === 'S' && board[row][col+1] === 'S') {
                        count++;
                        drawSOSLine(row, col-1, row, col+1, 'horizontal');
                        markSOSCells(row, col-1, row, col, row, col+1);
                    }
                }
                
                // Dikey kontrol (S-O-S)
                if (row > 0 && row < boardSize - 1) {
                    if (board[row-1][col] === 'S' && board[row+1][col] === 'S') {
                        count++;
                        drawSOSLine(row-1, col, row+1, col, 'vertical');
                        markSOSCells(row-1, col, row, col, row+1, col);
                    }
                }
                
                // Çapraz kontrol (sol üst - sağ alt) (S-O-S)
                if (row > 0 && col > 0 && row < boardSize - 1 && col < boardSize - 1) {
                    if (board[row-1][col-1] === 'S' && board[row+1][col+1] === 'S') {
                        count++;
                        drawSOSLine(row-1, col-1, row+1, col+1, 'diagonal');
                        markSOSCells(row-1, col-1, row, col, row+1, col+1);
                    }
                }
                
                // Çapraz kontrol (sağ üst - sol alt) (S-O-S)
                if (row > 0 && col < boardSize - 1 && row < boardSize - 1 && col > 0) {
                    if (board[row-1][col+1] === 'S' && board[row+1][col-1] === 'S') {
                        count++;
                        drawSOSLine(row-1, col+1, row+1, col-1, 'diagonal');
                        markSOSCells(row-1, col+1, row, col, row+1, col-1);
                    }
                }
            } 
            // Eğer 'S' harfi ise, sadece kendisi S olan SOS'leri kontrol et
            else if (letter === 'S') {
                // Sol tarafta O ve S varsa (S-O-S)
                if (col >= 2) {
                    if (board[row][col-2] === 'S' && board[row][col-1] === 'O') {
                        count++;
                        drawSOSLine(row, col-2, row, col, 'horizontal');
                        markSOSCells(row, col-2, row, col-1, row, col);
                    }
                }
                // Sağ tarafta O ve S varsa (S-O-S)
                if (col <= boardSize - 3) {
                    if (board[row][col+1] === 'O' && board[row][col+2] === 'S') {
                        count++;
                        drawSOSLine(row, col, row, col+2, 'horizontal');
                        markSOSCells(row, col, row, col+1, row, col+2);
                    }
                }
                // Üst tarafta O ve S varsa (S-O-S)
                if (row >= 2) {
                    if (board[row-2][col] === 'S' && board[row-1][col] === 'O') {
                        count++;
                        drawSOSLine(row-2, col, row, col, 'vertical');
                        markSOSCells(row-2, col, row-1, col, row, col);
                    }
                }
                // Alt tarafta O ve S varsa (S-O-S)
                if (row <= boardSize - 3) {
                    if (board[row+1][col] === 'O' && board[row+2][col] === 'S') {
                        count++;
                        drawSOSLine(row, col, row+2, col, 'vertical');
                        markSOSCells(row, col, row+1, col, row+2, col);
                    }
                }
                // Sol üst çaprazda O ve S varsa (S-O-S)
                if (row >= 2 && col >= 2) {
                    if (board[row-2][col-2] === 'S' && board[row-1][col-1] === 'O') {
                        count++;
                        drawSOSLine(row-2, col-2, row, col, 'diagonal');
                        markSOSCells(row-2, col-2, row-1, col-1, row, col);
                    }
                }
                // Sağ alt çaprazda O ve S varsa (S-O-S)
                if (row <= boardSize - 3 && col <= boardSize - 3) {
                    if (board[row+1][col+1] === 'O' && board[row+2][col+2] === 'S') {
                        count++;
                        drawSOSLine(row, col, row+2, col+2, 'diagonal');
                        markSOSCells(row, col, row+1, col+1, row+2, col+2);
                    }
                }
                // Sağ üst çaprazda O ve S varsa (S-O-S)
                if (row >= 2 && col <= boardSize - 3) {
                    if (board[row-2][col+2] === 'S' && board[row-1][col+1] === 'O') {
                        count++;
                        drawSOSLine(row-2, col+2, row, col, 'diagonal');
                        markSOSCells(row-2, col+2, row-1, col+1, row, col);
                    }
                }
                // Sol alt çaprazda O ve S varsa (S-O-S)
                if (row <= boardSize - 3 && col >= 2) {
                    if (board[row+1][col-1] === 'O' && board[row+2][col-2] === 'S') {
                        count++;
                        drawSOSLine(row, col, row+2, col-2, 'diagonal');
                        markSOSCells(row, col, row+1, col-1, row+2, col-2);
                    }
                }
            }
            
            return count;
        }
        
        // SOS hücrelerini işaretle
        function markSOSCells(r1, c1, r2, c2, r3, c3) {
            const cell1 = document.querySelector(`.cell[data-row="${r1}"][data-col="${c1}"]`);
            const cell2 = document.querySelector(`.cell[data-row="${r2}"][data-col="${c2}"]`);
            const cell3 = document.querySelector(`.cell[data-row="${r3}"][data-col="${c3}"]`);
            
            cell1.classList.add('sos-cell');
            cell2.classList.add('sos-cell');
            cell3.classList.add('sos-cell');
        }
        
        // SOS çizgisi çiz
        function drawSOSLine(startRow, startCol, endRow, endCol, type) {
            const startCell = document.querySelector(`.cell[data-row="${startRow}"][data-col="${startCol}"]`);
            const endCell = document.querySelector(`.cell[data-row="${endRow}"][data-col="${endCol}"]`);
            
            const startRect = startCell.getBoundingClientRect();
            const endRect = endCell.getBoundingClientRect();
            
            const boardRect = document.getElementById('game-board').getBoundingClientRect();
            
            const startX = startRect.left + startRect.width/2 - boardRect.left;
            const startY = startRect.top + startRect.height/2 - boardRect.top;
            const endX = endRect.left + endRect.width/2 - boardRect.left;
            const endY = endRect.top + endRect.height/2 - boardRect.top;
            
            const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
            const angle = Math.atan2(endY - startY, endX - startX) * 180 / Math.PI;
            
            const line = document.createElement('div');
            line.className = 'sos-line';
            line.style.width = `${length}px`;
            line.style.height = '4px';
            line.style.left = `${startX}px`;
            line.style.top = `${startY}px`;
            line.style.transform = `rotate(${angle}deg)`;
            
            // Çizgi tipine göre renk belirle
            if (type === 'horizontal') {
                line.style.background = 'rgba(255, 50, 50, 0.7)';
            } else if (type === 'vertical') {
                line.style.background = 'rgba(50, 50, 255, 0.7)';
            } else {
                line.style.background = 'rgba(50, 200, 50, 0.7)';
            }
            
            document.querySelector('.game-board').appendChild(line);
        }
        
        // Tüm hücreler dolu mu kontrol et
        function isBoardFull() {
            for (let i = 0; i < boardSize; i++) {
                for (let j = 0; j < boardSize; j++) {
                    if (board[i][j] === '') {
                        return false;
                    }
                }
            }
            return true;
        }
        
        // Oyunu bitir
        function endGame() {
            gameOver = true;
            const gameOverEl = document.getElementById('game-over');
            const winnerText = document.getElementById('winner-text');
            
            if (scores[0] > scores[1]) {
                winnerText.textContent = 'OYUNCU 1 KAZANDI!';
                winnerText.style.color = '#63e6be';
            } else if (scores[1] > scores[0]) {
                winnerText.textContent = 'OYUNCU 2 KAZANDI!';
                winnerText.style.color = '#ff8787';
            } else {
                winnerText.textContent = 'BERABERE!';
                winnerText.style.color = '#ffd43b';
            }
            
            gameOverEl.style.display = 'block';
            
            // Çevrimiçi moddaysa oyun sonucunu rakip oyuncuya ilet
            if (gameMode === "online" && socket.connected) {
                socket.emit('game-over', { 
                    roomId: currentRoomId, 
                    scores,
                    winner: scores[0] > scores[1] ? 1 : scores[1] > scores[0] ? 2 : 0
                });
            }
        }
        
        // Skorları güncelle
        function updateScores() {
            document.getElementById('score1').textContent = scores[0];
            document.getElementById('score2').textContent = scores[1];
        }
        
        // Mevcut oyuncuyu güncelle
        function updateCurrentPlayerDisplay() {
            const currentPlayerEl = document.getElementById('current-player');
            const playerName = currentPlayer === 1 ? 'Oyuncu 1' : 'Oyuncu 2';
            currentPlayerEl.textContent = `Sıra: ${playerName}`;
            currentPlayerEl.style.background = currentPlayer === 1 ? 
                'linear-gradient(90deg, #00b09b, #96c93d)' : 
                'linear-gradient(90deg, #ff6b6b, #ff8787)';
        }
        
        // Yeni oyun başlat
        function newGame() {
            board = Array(8).fill().map(() => Array(8).fill(''));
            currentPlayer = 1;
            scores = [0, 0];
            selectedLetter = 'S';
            gameOver = false;
            sosLines = [];
            moveHistory = [];
            
            document.getElementById('letter-s').classList.add('selected');
            document.getElementById('letter-o').classList.remove('selected');
            
            updateScores();
            updateCurrentPlayerDisplay();
            
            initializeBoard();
            
            document.getElementById('game-over').style.display = 'none';
            
            // Zamanlayıcıyı başlat
            startTimer();
            
            // Çevrimiçi moddaysa yeni oyunu rakip oyuncuya ilet
            if (gameMode === "online" && socket.connected) {
                socket.emit('new-game', { roomId: currentRoomId });
            }
        }
        
        // Oyunu sıfırla
        function resetGame() {
            // Tüm hücreleri temizle
            for (let i = 0; i < boardSize; i++) {
                for (let j = 0; j < boardSize; j++) {
                    board[i][j] = '';
                    const cell = document.querySelector(`.cell[data-row="${i}"][data-col="${j}"]`);
                    if (cell) {
                        cell.textContent = '';
                        cell.classList.remove('s', 'o', 'sos-cell');
                    }
                }
            }
            
            // Skorları sıfırla
            scores = [0, 0];
            updateScores();
            
            // Oyun durumunu sıfırla
            currentPlayer = 1;
            selectedLetter = 'S';
            gameOver = false;
            
            // Seçili harfi güncelle
            document.getElementById('letter-s').classList.add('selected');
            document.getElementById('letter-o').classList.remove('selected');
            
            // Mevcut oyuncu görüntüsünü güncelle
            updateCurrentPlayerDisplay();
            
            // Oyun bitti mesajını gizle
            document.getElementById('game-over').style.display = 'none';
            
            // Tüm SOS çizgilerini temizle
            document.querySelectorAll('.sos-line').forEach(line => line.remove());
            moveHistory = []; // History'i temizle
            
            // Zamanlayıcıyı başlat
            startTimer();
            
            // Çevrimiçi moddaysa sıfırlama işlemini rakip oyuncuya ilet
            if (gameMode === "online" && socket.connected) {
                socket.emit('reset-game', { roomId: currentRoomId });
            }
        }
        
        // Yardım talimatlarını göster/gizle
        function toggleInstructions() {
            const instructions = document.getElementById('instructions');
            instructions.style.display = instructions.style.display === 'none' ? 'block' : 'none';
        }
        
        // Çevrimiçi modu aç/kapa
        function toggleOnlineMode() {
            if (gameMode === "online") {
                // Çevrimiçi moddan çık
                startOfflineMode();
            } else {
                // Çevrimiçi moda gir
                startOnlineMode();
            }
        }
        
        // Çevrimiçi modu başlat
        function startOnlineMode() {
            if (!isLoggedIn) {
                alert('Çevrimiçi oynamak için giriş yapmalısınız!');
                document.getElementById('auth-container').style.display = 'flex';
                return;
            }
            
            gameMode = "online";
            document.getElementById('online-panel').style.display = 'block';
            document.getElementById('offline-mode').classList.remove('active');
            document.getElementById('online-mode').classList.add('active');
            document.getElementById('player2-name').textContent = 'Rakip Oyuncu';
            
            // Socket bağlantısını kontrol et
            if (!socket.connected) {
                alert("Sunucuya bağlanılamadı. Lütfen backend sunucusunun çalıştığından emin olun.");
                return;
            }
        }
        
        // Çevrimdışı moda geç
        function startOfflineMode() {
            gameMode = "offline";
            document.getElementById('online-panel').style.display = 'none';
            document.getElementById('online-mode').classList.remove('active');
            document.getElementById('offline-mode').classList.add('active');
            document.getElementById('player2-name').textContent = 'Bilgisayar';
            
            // Oyunu sıfırla
            resetGame();
        }
        
        // Oda oluştur
        function createRoom() {
            if (!isLoggedIn) {
                alert('Önce giriş yapmalısınız!');
                return;
            }
            
            currentRoomId = generateId();
            socket.emit('create-room', {
                userId: userData.id,
                userName: userData.name,
                roomId: currentRoomId
            });
        }
        
        // Odaya katıl
        function joinRoom() {
            if (!isLoggedIn) {
                alert('Önce giriş yapmalısınız!');
                return;
            }
            
            currentRoomId = document.getElementById('room-id').value.trim();
            if (!currentRoomId) {
                alert('Lütfen bir oda ID\'si girin!');
                return;
            }
            
            socket.emit('join-room', {
                roomId: currentRoomId,
                userId: userData.id,
                userName: userData.name
            });
        }
        
        // Kullanıcı girişi yap
        function loginUser() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (!email || !password) {
                alert('Lütfen e-posta ve şifre giriniz!');
                return;
            }
            
            // Basit doğrulama
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Lütfen geçerli bir e-posta adresi giriniz!');
                return;
            }
            
            // Burada normalde sunucuya istek atılır, şimdilik simüle ediyoruz
            userData = {
                id: generateId(),
                name: email.split('@')[0],
                email: email
            };
            
            isLoggedIn = true;
            
            // Kullanıcı arayüzünü güncelle
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('user-panel').style.display = 'flex';
            document.getElementById('user-name').textContent = userData.name;
            document.getElementById('user-avatar').textContent = userData.name.charAt(0).toUpperCase();
            document.getElementById('player-id').textContent = userData.id;
            
            // Oyunu başlat
            newGame();
        }
        
        // Kullanıcı kaydı yap
        function registerUser() {
            const name = document.getElementById('register-name').value;
            const surname = document.getElementById('register-surname').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;
            
            if (!name || !surname || !email || !password || !confirm) {
                alert('Lütfen tüm alanları doldurunuz!');
                return;
            }
            
            if (password !== confirm) {
                alert('Şifreler eşleşmiyor!');
                return;
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Lütfen geçerli bir e-posta adresi giriniz!');
                return;
            }
            
            // Burada normalde sunucuya istek atılır, şimdilik simüle ediyoruz
            userData = {
                id: generateId(),
                name: `${name} ${surname}`,
                email: email
            };
            
            isLoggedIn = true;
            
            // Kullanıcı arayüzünü güncelle
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('user-panel').style.display = 'flex';
            document.getElementById('user-name').textContent = userData.name;
            document.getElementById('user-avatar').textContent = name.charAt(0).toUpperCase();
            document.getElementById('player-id').textContent = userData.id;
            
            // Oyunu başlat
            newGame();
        }
        
        // Sayfa yüklendiğinde
        window.onload = function() {
            // Harf seçim olaylarını ekle
            document.getElementById('letter-s').addEventListener('click', () => {
                selectedLetter = 'S';
                document.getElementById('letter-s').classList.add('selected');
                document.getElementById('letter-o').classList.remove('selected');
            });
            
            document.getElementById('letter-o').addEventListener('click', () => {
                selectedLetter = 'O';
                document.getElementById('letter-o').classList.add('selected');
                document.getElementById('letter-s').classList.remove('selected');
            });
            
            // Kimlik doğrulama olayları
            document.getElementById('login-btn').addEventListener('click', loginUser);
            document.getElementById('register-btn').addEventListener('click', registerUser);
            
            document.getElementById('switch-to-register').addEventListener('click', () => {
                document.getElementById('login-tab').classList.remove('active');
                document.getElementById('register-tab').classList.add('active');
                document.getElementById('login-form').classList.remove('active');
                document.getElementById('register-form').classList.add('active');
            });
            
            document.getElementById('switch-to-login').addEventListener('click', () => {
                document.getElementById('register-tab').classList.remove('active');
                document.getElementById('login-tab').classList.add('active');
                document.getElementById('register-form').classList.remove('active');
                document.getElementById('login-form').classList.add('active');
            });
            
            // Oyun modu seçimi
            document.getElementById('online-mode').addEventListener('click', startOnlineMode);
            document.getElementById('offline-mode').addEventListener('click', startOfflineMode);
            
            // Çıkış butonu
            document.getElementById('logout-btn').addEventListener('click', () => {
                isLoggedIn = false;
                userData = null;
                document.getElementById('user-panel').style.display = 'none';
                document.getElementById('auth-container').style.display = 'flex';
                startOfflineMode();
            });
            
            // Çevrimiçi kontroller
            document.getElementById('create-room').addEventListener('click', createRoom);
            document.getElementById('join-room').addEventListener('click', joinRoom);
            
            // Oyunu başlat
            initializeBoard();
        };
    </script>
</body>
</html>